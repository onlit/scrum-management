// @gen:AUTO_GENERATED - This file is generated by compute-rapi
// apps/@gen{MICROSERVICE_SLUG}/src/pages/[listType]/[id].tsx
import { GetServerSidePropsContext } from 'next';
import withProtectedV2 from '@ps/shared-core/config/withProtectedV2';
import GenericDetailPage from '@/components/GenericDetailPage';
import { getEntityConfig, isValidEntitySlug } from '@/config/entityRegistry';
import ErrorPage from '@ps/shared-core/ui/ErrorPage';

interface DetailPageProps {
  listType: string;
  isValid: boolean;
}

export const getServerSideProps = withProtectedV2(
  async (context: GetServerSidePropsContext) => {
    const listType = context.params?.listType as string;
    const isValid = isValidEntitySlug(listType);

    if (!isValid) {
      return {
        notFound: true,
      };
    }

    return {
      props: {
        listType,
        isValid,
      },
    };
  }
);

export default function DynamicDetailPage({ listType, isValid }: DetailPageProps) {
  if (!isValid) {
    return (
      <ErrorPage
        variant="notFound"
        title="Entity type not found"
        description={`The entity type "${listType}" does not exist.`}
        showHomeButton
        showBackButton={false}
      />
    );
  }

  const entityConfig = getEntityConfig(listType);

  return (
    <GenericDetailPage
      entityConfig={entityConfig}
      entitySlug={listType}
    />
  );
}
