// /**
//  * CREATED BY: Umer Lachi
//  * CREATOR EMAIL: umer@pullstream.com
//  * CREATION DATE: 25/08/2025
//  *
//  *
//  * DESCRIPTION:
//  * ------------------
//  * This file defines the data model and schema configuration for an application using Prisma. It includes declarations of database tables as models, specifying fields, types, relations, indexes, and other database constraints. The schema.prisma file acts as the central definition for the structure of the database, informing Prisma's client generator how to construct queries and mutations based on the defined schema. Additionally, it can be used to configure database connections and Prisma's behavior, ensuring that the application's data layer is well-organized, maintainable, and aligned with the application's data requirements.
//  *
//  *
//  */

// Defines the Prisma client generator configuration.
// This specifies the use of the Prisma Client JS as the database client for interacting with the database.
generator client {
  provider = "prisma-client-js"
}

// Configures the database connection details.
// Uses PostgreSQL as the database provider and reads the connection URL from an environment variable.
datasource db {
  provider  = "postgresql"
  url       = env("PGBOUNCER_URL")
  directUrl = env("DATABASE_URL")
}

enum DataExchangeLogType {
  EXPORT
  IMPORT
}

enum DataExchangeLogStatus {
  COMPLETED
  FAILED
  PROCESSING
}

enum ActionReminderProgress {
  IN_PROGRESS
  COMPLETED
}

enum PersonStatus {
  APPLICANT
  NEW
}

enum TargetFrequency {
  DAILY
  WEEKLY
  MONTHLY
}

enum ActionReminderType {
  REMINDER_EVENT
  INA_REMINDER_EVENT
}

enum CompanySize {
  SIZE_2_TO_10
  SIZE_1
  SIZE_11_TO_50
  SIZE_51_TO_100
  SIZE_101_TO_250
  SIZE_501_TO_1000
  SIZE_251_TO_500
  SIZE_1001_TO_10000
}

enum CompanySpinBuyerInfluence {
  USER
  TECHNICAL
  ECONOMIC
}

enum ProspectTemperature {
  COLD
  WARM
  HOT
}

enum ProspectDisqualificationReason {
  NO_BUDGET
  WRONG_TIMING
  LOST_TO_COMPETITOR
  UNRESPONSIVE
  NOT_A_FIT
  OTHER
}

// The DataExchangeLog model serves as a comprehensive log for tracking and
// auditing data import and export operations within the system. It records the
// details of each operation, including its type (import or export), status,
// associated file information, and any errors encountered. This model facilitates
// monitoring data movement activities, ensures data integrity, and supports
// troubleshooting by providing insights into the success or failure of data
// exchange processes. Visibility controls and association with specific clients
// and users enable fine-grained access and accountability.
model DataExchangeLog {
  id                              String                @id @default(uuid()) @db.Uuid()
  type                            DataExchangeLogType // 'IMPORT' or 'EXPORT'
  status                          DataExchangeLogStatus @default(PROCESSING)
  modelName                       String // Name of the model being imported/exported
  filePath                        String? // Path to the file being imported/exported
  failureReason                   String? // Error message in case the job fails
  completedAt                     DateTime? // When the job was completed
  failedAt                        DateTime? // When the job failed
  importedRowsCount               Int? // Number of rows imported
  errorsRowsCount                 Int? // Number of rows failed to import
  metaData                        Json?
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean               @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean               @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean               @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String                @db.Uuid() // Identifier for the client associated.
  createdBy                       String                @db.Uuid() // User ID of the creator.
  updatedBy                       String                @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime              @default(now()) // Creation timestamp.
  updatedAt                       DateTime              @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
}

// Defines the nature of the connection between two records, such as the
// relationship between two contacts or a contact and a company.
model Relationship {
  id                                         String               @id @default(uuid()) @db.Uuid()
  name                                       String
  description                                String?
  color                                      String?              @db.VarChar(40)
  relationshipPersonRelationshipRelationship PersonRelationship[] @relation("PersonRelationshipRelationshipRelationshipId")
  tags                                       String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                           Boolean              @default(false) // Visibility control.
  anonymousCanSeeIt                          Boolean              @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt            Boolean              @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                     Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                     Json? // Specific users with visibility access.
  client                                     String               @db.Uuid() // Identifier for the client associated.
  createdBy                                  String               @db.Uuid() // User ID of the creator.
  updatedBy                                  String               @db.Uuid() // User ID of the last updater.
  createdAt                                  DateTime             @default(now()) // Creation timestamp.
  updatedAt                                  DateTime             @updatedAt // Last update timestamp.
  deleted                                    DateTime? // Deletion timestamp, if deleted.
  workflowId                                 String?              @db.Uuid()
  workflowInstanceId                         String?              @db.Uuid()
  isSystemTemplate                           Boolean              @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Defines different types of social media platforms, such as 'LinkedIn',
// 'Twitter', 'Facebook', etc.
model SocialMediaType {
  id                                           String               @id @default(uuid()) @db.Uuid()
  name                                         String               @db.VarChar(50)
  color                                        String?              @db.VarChar(40)
  description                                  String?
  socialMediaTypeCompanySocialMediaSocialMedia CompanySocialMedia[] @relation("CompanySocialMediaSocialMediaTypeSocialMediaId")
  socialMediaTypePersonSocialMediaSocialMedia  PersonSocialMedia[]  @relation("PersonSocialMediaSocialMediaTypeSocialMediaId")
  tags                                         String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                             Boolean              @default(false) // Visibility control.
  anonymousCanSeeIt                            Boolean              @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt              Boolean              @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                       Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                       Json? // Specific users with visibility access.
  client                                       String               @db.Uuid() // Identifier for the client associated.
  createdBy                                    String               @db.Uuid() // User ID of the creator.
  updatedBy                                    String               @db.Uuid() // User ID of the last updater.
  createdAt                                    DateTime             @default(now()) // Creation timestamp.
  updatedAt                                    DateTime             @updatedAt // Last update timestamp.
  deleted                                      DateTime? // Deletion timestamp, if deleted.
  workflowId                                   String?              @db.Uuid()
  workflowInstanceId                           String?              @db.Uuid()
  isSystemTemplate                             Boolean              @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Defines a geographical area, market segment, or group of accounts that a sales
// person or team is responsible for.
model Territory {
  id                                   String               @id @default(uuid()) @db.Uuid()
  description                          String?
  name                                 String
  color                                String?              @db.VarChar(40)
  expiryDate                           DateTime?            @db.Date
  territoryCompanyInTerritoryTerritory CompanyInTerritory[] @relation("CompanyInTerritoryTerritoryTerritoryId")
  territoryTerritoryOwnerTerritory     TerritoryOwner[]     @relation("TerritoryOwnerTerritoryTerritoryId")
  tags                                 String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                     Boolean              @default(false) // Visibility control.
  anonymousCanSeeIt                    Boolean              @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt      Boolean              @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt               Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt               Json? // Specific users with visibility access.
  client                               String               @db.Uuid() // Identifier for the client associated.
  createdBy                            String               @db.Uuid() // User ID of the creator.
  updatedBy                            String               @db.Uuid() // User ID of the last updater.
  createdAt                            DateTime             @default(now()) // Creation timestamp.
  updatedAt                            DateTime             @updatedAt // Last update timestamp.
  deleted                              DateTime? // Deletion timestamp, if deleted.
  workflowId                           String?              @db.Uuid()
  workflowInstanceId                   String?              @db.Uuid()
  isSystemTemplate                     Boolean              @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Defines the various channels through which interactions or sales occur, such as
// 'Website', 'Email', 'Phone', or 'In-Person'.
model Channel {
  id                              String        @id @default(uuid()) @db.Uuid()
  color                           String?       @db.VarChar(40)
  description                     String?
  name                            String
  channelOpportunityChannel       Opportunity[] @relation("OpportunityChannelChannelId")
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean       @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean       @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean       @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String        @db.Uuid() // Identifier for the client associated.
  createdBy                       String        @db.Uuid() // User ID of the creator.
  updatedBy                       String        @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime      @default(now()) // Creation timestamp.
  updatedAt                       DateTime      @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?       @db.Uuid()
  workflowInstanceId              String?       @db.Uuid()
  isSystemTemplate                Boolean       @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Categorizes the reason for a customer enquiry, such as product information,
// support request, or billing question.
model CustomerEnquiryPurpose {
  id                                           String            @id @default(uuid()) @db.Uuid()
  name                                         String
  description                                  String?
  color                                        String?           @db.VarChar(40)
  customerEnquiryPurposeCustomerEnquiryPurpose CustomerEnquiry[] @relation("CustomerEnquiryCustomerEnquiryPurposePurposeId")
  tags                                         String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                             Boolean           @default(false) // Visibility control.
  anonymousCanSeeIt                            Boolean           @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt              Boolean           @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                       Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                       Json? // Specific users with visibility access.
  client                                       String            @db.Uuid() // Identifier for the client associated.
  createdBy                                    String            @db.Uuid() // User ID of the creator.
  updatedBy                                    String            @db.Uuid() // User ID of the last updater.
  createdAt                                    DateTime          @default(now()) // Creation timestamp.
  updatedAt                                    DateTime          @updatedAt // Last update timestamp.
  deleted                                      DateTime? // Deletion timestamp, if deleted.
  workflowId                                   String?           @db.Uuid()
  workflowInstanceId                           String?           @db.Uuid()
  isSystemTemplate                             Boolean           @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Tracks the current status of a customer enquiry, such as 'New', 'In Progress',
// or 'Resolved'.
model CustomerEnquiryStatus {
  id                                         String            @id @default(uuid()) @db.Uuid()
  color                                      String?           @db.VarChar(40)
  name                                       String
  description                                String?
  customerEnquiryStatusCustomerEnquiryStatus CustomerEnquiry[] @relation("CustomerEnquiryCustomerEnquiryStatusStatusId")
  tags                                       String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                           Boolean           @default(false) // Visibility control.
  anonymousCanSeeIt                          Boolean           @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt            Boolean           @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                     Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                     Json? // Specific users with visibility access.
  client                                     String            @db.Uuid() // Identifier for the client associated.
  createdBy                                  String            @db.Uuid() // User ID of the creator.
  updatedBy                                  String            @db.Uuid() // User ID of the last updater.
  createdAt                                  DateTime          @default(now()) // Creation timestamp.
  updatedAt                                  DateTime          @updatedAt // Last update timestamp.
  deleted                                    DateTime? // Deletion timestamp, if deleted.
  workflowId                                 String?           @db.Uuid()
  workflowInstanceId                         String?           @db.Uuid()
  isSystemTemplate                           Boolean           @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Represents a complete sales or business process, composed of a sequence of
// stages that an opportunity or lead moves through.
model Pipeline {
  id                                String              @id @default(uuid()) @db.Uuid()
  color                             String?             @db.VarChar(40)
  description                       String?
  name                              String              @db.VarChar(50)
  pipelinePipelineStagePipeline     PipelineStage[]     @relation("PipelineStagePipelinePipelineId")
  pipelineSalesPersonTargetPipeline SalesPersonTarget[] @relation("SalesPersonTargetPipelinePipelineId")
  pipelineOpportunityPipeline       Opportunity[]       @relation("OpportunityPipelinePipelineId")
  tags                              String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                  Boolean             @default(false) // Visibility control.
  anonymousCanSeeIt                 Boolean             @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt   Boolean             @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt            Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt            Json? // Specific users with visibility access.
  client                            String              @db.Uuid() // Identifier for the client associated.
  createdBy                         String              @db.Uuid() // User ID of the creator.
  updatedBy                         String              @db.Uuid() // User ID of the last updater.
  createdAt                         DateTime            @default(now()) // Creation timestamp.
  updatedAt                         DateTime            @updatedAt // Last update timestamp.
  deleted                           DateTime? // Deletion timestamp, if deleted.
  workflowId                        String?             @db.Uuid()
  workflowInstanceId                String?             @db.Uuid()
  isSystemTemplate                  Boolean             @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Defines a series of stages for managing contacts on a call list, from initial
// attempt to final outcome.
model CallListPipeline {
  id                                                    String                  @id @default(uuid()) @db.Uuid()
  color                                                 String?                 @db.VarChar(40)
  description                                           String?
  name                                                  String
  callListPipelineCallListPipelineStageCallListPipeline CallListPipelineStage[] @relation("CallListPipelineStageCallListPipelineCallListPipelineId")
  callListPipelineCallListCallListPipeline              CallList[]              @relation("CallListCallListPipelineCallListPipelineId")
  tags                                                  String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                                      Boolean                 @default(false) // Visibility control.
  anonymousCanSeeIt                                     Boolean                 @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt                       Boolean                 @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                                Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                                Json? // Specific users with visibility access.
  client                                                String                  @db.Uuid() // Identifier for the client associated.
  createdBy                                             String                  @db.Uuid() // User ID of the creator.
  updatedBy                                             String                  @db.Uuid() // User ID of the last updater.
  createdAt                                             DateTime                @default(now()) // Creation timestamp.
  updatedAt                                             DateTime                @updatedAt // Last update timestamp.
  deleted                                               DateTime? // Deletion timestamp, if deleted.
  workflowId                                            String?                 @db.Uuid()
  workflowInstanceId                                    String?                 @db.Uuid()
  isSystemTemplate                                      Boolean                 @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Defines a distinct stage within a sales or business process pipeline, such as
// 'Qualification', 'Proposal', or 'Closed Won'.
model PipelineStage {
  id                                            String              @id @default(uuid()) @db.Uuid()
  parentPipelineStageId                         String?             @db.Uuid()
  parentPipelineStage                           PipelineStage?      @relation("PipelineStagePipelineStageParentPipelineStageId", fields: [parentPipelineStageId], references: [id])
  pipelineId                                    String?             @db.Uuid()
  pipeline                                      Pipeline?           @relation("PipelineStagePipelinePipelineId", fields: [pipelineId], references: [id])
  order                                         Int
  immediateNextAction                           String?             @db.VarChar(200)
  description                                   String?
  confidence                                    Int
  color                                         String?             @db.VarChar(40)
  rottingDays                                   Int
  conversion                                    Int
  stage                                         String              @db.VarChar(150)
  pipelineStagePipelineStageParentPipelineStage PipelineStage[]     @relation("PipelineStagePipelineStageParentPipelineStageId")
  pipelineStageSalesPersonTargetPipelineStage   SalesPersonTarget[] @relation("SalesPersonTargetPipelineStagePipelineStageId")
  pipelineStageOpportunityStatus                Opportunity[]       @relation("OpportunityPipelineStageStatusId")
  tags                                          String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                              Boolean             @default(false) // Visibility control.
  anonymousCanSeeIt                             Boolean             @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt               Boolean             @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                        Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                        Json? // Specific users with visibility access.
  client                                        String              @db.Uuid() // Identifier for the client associated.
  createdBy                                     String              @db.Uuid() // User ID of the creator.
  updatedBy                                     String              @db.Uuid() // User ID of the last updater.
  createdAt                                     DateTime            @default(now()) // Creation timestamp.
  updatedAt                                     DateTime            @updatedAt // Last update timestamp.
  deleted                                       DateTime? // Deletion timestamp, if deleted.
  workflowId                                    String?             @db.Uuid()
  workflowInstanceId                            String?             @db.Uuid()
  isSystemTemplate                              Boolean             @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
  @@index([pipelineId, deleted, order])
}

// Represents a single stage within a call list pipeline, used to track the
// progress of contacts on a call list.
model CallListPipelineStage {
  id                                                     String            @id @default(uuid()) @db.Uuid()
  color                                                  String?           @db.VarChar(40)
  order                                                  Decimal
  rottingDays                                            Int
  name                                                   String
  description                                            String?
  callListPipelineId                                     String?           @db.Uuid()
  callListPipeline                                       CallListPipeline? @relation("CallListPipelineStageCallListPipelineCallListPipelineId", fields: [callListPipelineId], references: [id])
  callListPipelineStageCallScheduleCallListPipelineStage CallSchedule[]    @relation("CallScheduleCallListPipelineStageCallListPipelineStageId")
  callListPipelineStageCallHistoryCallListPipelineStage  CallHistory[]     @relation("CallHistoryCallListPipelineStageCallListPipelineStageId")
  tags                                                   String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                                       Boolean           @default(false) // Visibility control.
  anonymousCanSeeIt                                      Boolean           @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt                        Boolean           @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                                 Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                                 Json? // Specific users with visibility access.
  client                                                 String            @db.Uuid() // Identifier for the client associated.
  createdBy                                              String            @db.Uuid() // User ID of the creator.
  updatedBy                                              String            @db.Uuid() // User ID of the last updater.
  createdAt                                              DateTime          @default(now()) // Creation timestamp.
  updatedAt                                              DateTime          @updatedAt // Last update timestamp.
  deleted                                                DateTime? // Deletion timestamp, if deleted.
  workflowId                                             String?           @db.Uuid()
  workflowInstanceId                                     String?           @db.Uuid()
  isSystemTemplate                                       Boolean           @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Represents a company or organization. This is a central record for storing
// company-level information and for associating contacts and opportunities.
model Company {
  id                                    String                    @id @default(uuid()) @db.Uuid()
  staffUrl                              String?
  email                                 String?
  website                               String?
  notes                                 String?
  city                                  String?
  state                                 String?
  zip                                   String?                   @db.VarChar(15)
  industry                              String?
  name                                  String                    @db.VarChar(150)
  color                                 String?                   @db.VarChar(40)
  description                           String?
  companyIntelligence                   String?
  size                                  CompanySize?
  keywords                              String?
  contactUrl                            String?
  phone                                 String?                   @db.VarChar(25)
  fax                                   String?                   @db.VarChar(25)
  address1                              String?
  address2                              String?
  branchOfId                            String?                   @db.Uuid()
  branchOf                              Company?                  @relation("CompanyCompanyBranchOfId", fields: [branchOfId], references: [id])
  betaPartners                          Boolean
  ownerId                               String?                   @db.Uuid()
  newsUrl                               String?
  countryId                             String?                   @db.Uuid()
  stateId                               String?                   @db.Uuid() // External Foreign Key from Lists V2 app
  cityId                                String?                   @db.Uuid() // External Foreign Key from Lists V2 app
  industryId                            String?                   @db.Uuid() // External Foreign Key from Lists V2 app
  search_vector                         Unsupported("tsvector")?  @map("search_vector")
  companyCompanyBranchOf                Company[]                 @relation("CompanyCompanyBranchOfId")
  companyPersonCompanyOwner             Person[]                  @relation("PersonCompanyCompanyOwnerId")
  companyCompanyHistoryCompany          CompanyHistory[]          @relation("CompanyHistoryCompanyCompanyId")
  companyCompanySocialMediaCompany      CompanySocialMedia[]      @relation("CompanySocialMediaCompanyCompanyId")
  companyCompanySpinCompany             CompanySpin[]             @relation("CompanySpinCompanyCompanyId")
  companyAccountManagerInCompanyCompany AccountManagerInCompany[] @relation("AccountManagerInCompanyCompanyCompanyId")
  companyCompanyInTerritoryCompany      CompanyInTerritory[]      @relation("CompanyInTerritoryCompanyCompanyId")
  companyCompanyContactCompany          CompanyContact[]          @relation("CompanyContactCompanyCompanyId")
  companyOpportunityCompany             Opportunity[]             @relation("OpportunityCompanyCompanyId")
  tags                                  String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                      Boolean                   @default(false) // Visibility control.
  anonymousCanSeeIt                     Boolean                   @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt       Boolean                   @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                Json? // Specific users with visibility access.
  client                                String                    @db.Uuid() // Identifier for the client associated.
  createdBy                             String                    @db.Uuid() // User ID of the creator.
  updatedBy                             String                    @db.Uuid() // User ID of the last updater.
  createdAt                             DateTime                  @default(now()) // Creation timestamp.
  updatedAt                             DateTime                  @updatedAt // Last update timestamp.
  deleted                               DateTime? // Deletion timestamp, if deleted.
  workflowId                            String?                   @db.Uuid()
  workflowInstanceId                    String?                   @db.Uuid()
  isSystemTemplate                      Boolean                   @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt, ownerId, countryId, stateId, cityId, industryId])
}

// Represents an individual person, such as a contact, lead, or user. This is the
// core record for storing personal information.
model Person {
  id                                String                   @id @default(uuid()) @db.Uuid()
  color                             String?                  @db.VarChar(40)
  middleName                        String?                  @db.VarChar(100)
  dob                               DateTime?                @db.Date
  personalMobile                    String?                  @db.VarChar(50)
  address2                          String?
  state                             String?
  owner                             String?                  @db.VarChar(50)
  source                            String?
  preferredName                     String?                  @db.VarChar(100)
  username                          String?                  @db.VarChar(100)
  avatar                            String?                  @db.VarChar(200)
  countryId                         String?                  @db.Uuid()
  stateId                           String?                  @db.Uuid() // External Foreign Key from Lists V2 app
  cityId                            String?                  @db.Uuid() // External Foreign Key from Lists V2 app
  homePhone                         String?                  @db.VarChar(50)
  city                              String?
  parentId                          String?                  @db.Uuid()
  parent                            Person?                  @relation("PersonPersonParentId", fields: [parentId], references: [id])
  companyOwnerId                    String?                  @db.Uuid()
  companyOwner                      Company?                 @relation("PersonCompanyCompanyOwnerId", fields: [companyOwnerId], references: [id])
  hasWhatsapp                       Boolean
  address1                          String?
  notes                             String?
  firstName                         String                   @db.VarChar(100)
  zip                               String?                  @db.VarChar(15)
  sourceNotes                       String?
  lastName                          String?                  @db.VarChar(100)
  user                              String?                  @db.Uuid()
  email                             String
  status                            PersonStatus?
  search_vector                     Unsupported("tsvector")? @map("search_vector")
  personPersonParent                Person[]                 @relation("PersonPersonParentId")
  personPersonHistoryPerson         PersonHistory[]          @relation("PersonHistoryPersonPersonId")
  personPersonSocialMediaPerson     PersonSocialMedia[]      @relation("PersonSocialMediaPersonPersonId")
  personPersonInMarketingListPerson PersonInMarketingList[]  @relation("PersonInMarketingListPersonPersonId")
  personPersonRelationshipPerson    PersonRelationship[]     @relation("PersonRelationshipPersonPersonId")
  personCompanyContactPerson        CompanyContact[]         @relation("CompanyContactPersonPersonId")
  personCustomerEnquiryPerson       CustomerEnquiry[]        @relation("CustomerEnquiryPersonPersonId")
  personOpportunityPerson           Opportunity[]            @relation("OpportunityPersonPersonId")
  personCallSchedulePerson          CallSchedule[]           @relation("CallSchedulePersonPersonId")
  personProspectPerson              Prospect[]               @relation("ProspectToPerson")
  tags                              String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                  Boolean                  @default(false) // Visibility control.
  anonymousCanSeeIt                 Boolean                  @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt   Boolean                  @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt            Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt            Json? // Specific users with visibility access.
  client                            String                   @db.Uuid() // Identifier for the client associated.
  createdBy                         String                   @db.Uuid() // User ID of the creator.
  updatedBy                         String                   @db.Uuid() // User ID of the last updater.
  createdAt                         DateTime                 @default(now()) // Creation timestamp.
  updatedAt                         DateTime                 @updatedAt // Last update timestamp.
  deleted                           DateTime? // Deletion timestamp, if deleted.
  workflowId                        String?                  @db.Uuid()
  workflowInstanceId                String?                  @db.Uuid()
  isSystemTemplate                  Boolean                  @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt, countryId, stateId, cityId])
}

// A dynamic or static list of contacts used for targeted marketing campaigns, such
// as email newsletters or promotions.
model MarketingList {
  id                                              String                  @id @default(uuid()) @db.Uuid()
  name                                            String
  color                                           String?                 @db.VarChar(40)
  expiryDate                                      DateTime?               @db.Date
  description                                     String?
  marketingListPersonInMarketingListMarketingList PersonInMarketingList[] @relation("PersonInMarketingListMarketingListMarketingListId")
  tags                                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                                Boolean                 @default(false) // Visibility control.
  anonymousCanSeeIt                               Boolean                 @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt                 Boolean                 @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                          Json? // Specific users with visibility access.
  client                                          String                  @db.Uuid() // Identifier for the client associated.
  createdBy                                       String                  @db.Uuid() // User ID of the creator.
  updatedBy                                       String                  @db.Uuid() // User ID of the last updater.
  createdAt                                       DateTime                @default(now()) // Creation timestamp.
  updatedAt                                       DateTime                @updatedAt // Last update timestamp.
  deleted                                         DateTime? // Deletion timestamp, if deleted.
  workflowId                                      String?                 @db.Uuid()
  workflowInstanceId                              String?                 @db.Uuid()
  isSystemTemplate                                Boolean                 @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// A historical log of all changes made to a company record, including updates to
// its name, address, or status.
model CompanyHistory {
  id                              String    @id @default(uuid()) @db.Uuid()
  history                         String
  color                           String?   @db.VarChar(40)
  notes                           String?
  companyId                       String    @db.Uuid()
  company                         Company   @relation("CompanyHistoryCompanyCompanyId", fields: [companyId], references: [id])
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean   @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean   @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean   @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String    @db.Uuid() // Identifier for the client associated.
  createdBy                       String    @db.Uuid() // User ID of the creator.
  updatedBy                       String    @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime  @default(now()) // Creation timestamp.
  updatedAt                       DateTime  @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?   @db.Uuid()
  workflowInstanceId              String?   @db.Uuid()
  isSystemTemplate                Boolean   @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Stores a link to a company's social media profile, such as its corporate
// LinkedIn page or Twitter account.
model CompanySocialMedia {
  id                              String           @id @default(uuid()) @db.Uuid()
  color                           String?          @db.VarChar(40)
  companyId                       String?          @db.Uuid()
  company                         Company?         @relation("CompanySocialMediaCompanyCompanyId", fields: [companyId], references: [id])
  url                             String
  socialMediaId                   String?          @db.Uuid()
  socialMedia                     SocialMediaType? @relation("CompanySocialMediaSocialMediaTypeSocialMediaId", fields: [socialMediaId], references: [id])
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean          @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean          @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean          @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String           @db.Uuid() // Identifier for the client associated.
  createdBy                       String           @db.Uuid() // User ID of the creator.
  updatedBy                       String           @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime         @default(now()) // Creation timestamp.
  updatedAt                       DateTime         @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?          @db.Uuid()
  workflowInstanceId              String?          @db.Uuid()
  isSystemTemplate                Boolean          @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Represents a new company that has been spun off from an existing parent company.
model CompanySpin {
  id                                            String                    @id @default(uuid()) @db.Uuid()
  situation                                     String
  implication                                   String
  need                                          String
  companyId                                     String                    @db.Uuid()
  company                                       Company                   @relation("CompanySpinCompanyCompanyId", fields: [companyId], references: [id])
  notes                                         String?
  color                                         String?                   @db.VarChar(40)
  buyerInfluence                                CompanySpinBuyerInfluence
  problem                                       String
  companySpinOpportunityEconomicBuyerInfluence  Opportunity[]             @relation("OpportunityCompanySpinEconomicBuyerInfluenceId")
  companySpinOpportunityTechnicalBuyerInfluence Opportunity[]             @relation("OpportunityCompanySpinTechnicalBuyerInfluenceId")
  companySpinOpportunityUserBuyerInfluence      Opportunity[]             @relation("OpportunityCompanySpinUserBuyerInfluenceId")
  tags                                          String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                              Boolean                   @default(false) // Visibility control.
  anonymousCanSeeIt                             Boolean                   @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt               Boolean                   @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                        Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                        Json? // Specific users with visibility access.
  client                                        String                    @db.Uuid() // Identifier for the client associated.
  createdBy                                     String                    @db.Uuid() // User ID of the creator.
  updatedBy                                     String                    @db.Uuid() // User ID of the last updater.
  createdAt                                     DateTime                  @default(now()) // Creation timestamp.
  updatedAt                                     DateTime                  @updatedAt // Last update timestamp.
  deleted                                       DateTime? // Deletion timestamp, if deleted.
  workflowId                                    String?                   @db.Uuid()
  workflowInstanceId                            String?                   @db.Uuid()
  isSystemTemplate                              Boolean                   @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Assigns a user as the primary account manager for a specific company.
model AccountManagerInCompany {
  id                              String    @id @default(uuid()) @db.Uuid()
  color                           String?   @db.VarChar(40)
  expiryDate                      DateTime? @db.Date
  companyId                       String    @db.Uuid()
  company                         Company   @relation("AccountManagerInCompanyCompanyCompanyId", fields: [companyId], references: [id])
  accountManagerId                String    @db.Uuid()
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean   @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean   @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean   @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String    @db.Uuid() // Identifier for the client associated.
  createdBy                       String    @db.Uuid() // User ID of the creator.
  updatedBy                       String    @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime  @default(now()) // Creation timestamp.
  updatedAt                       DateTime  @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?   @db.Uuid()
  workflowInstanceId              String?   @db.Uuid()
  isSystemTemplate                Boolean   @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt, accountManagerId])
}

// Links a company record to a specific sales territory, used for assignment and
// reporting.
model CompanyInTerritory {
  id                              String    @id @default(uuid()) @db.Uuid()
  companyId                       String?   @db.Uuid()
  company                         Company?  @relation("CompanyInTerritoryCompanyCompanyId", fields: [companyId], references: [id])
  color                           String?   @db.VarChar(40)
  expiryDate                      DateTime? @db.Date
  territoryId                     String    @db.Uuid()
  territory                       Territory @relation("CompanyInTerritoryTerritoryTerritoryId", fields: [territoryId], references: [id])
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean   @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean   @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean   @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String    @db.Uuid() // Identifier for the client associated.
  createdBy                       String    @db.Uuid() // User ID of the creator.
  updatedBy                       String    @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime  @default(now()) // Creation timestamp.
  updatedAt                       DateTime  @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?   @db.Uuid()
  workflowInstanceId              String?   @db.Uuid()
  isSystemTemplate                Boolean   @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
  // Performance: support controller-level uniqueness and lookups
  @@index([client, deleted, territoryId, companyId, expiryDate])
  @@index([territoryId, deleted])
  @@index([companyId, deleted])
}

// A record of all significant changes and interactions associated with a person,
// creating a complete audit trail.
model PersonHistory {
  id                              String    @id @default(uuid()) @db.Uuid()
  notes                           String
  color                           String?   @db.VarChar(40)
  history                         String?
  personId                        String    @db.Uuid()
  person                          Person    @relation("PersonHistoryPersonPersonId", fields: [personId], references: [id])
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean   @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean   @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean   @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String    @db.Uuid() // Identifier for the client associated.
  createdBy                       String    @db.Uuid() // User ID of the creator.
  updatedBy                       String    @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime  @default(now()) // Creation timestamp.
  updatedAt                       DateTime  @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?   @db.Uuid()
  workflowInstanceId              String?   @db.Uuid()
  isSystemTemplate                Boolean   @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Stores a link to a person's social media profile, associating it with their
// contact record.
model PersonSocialMedia {
  id                              String           @id @default(uuid()) @db.Uuid()
  color                           String?          @db.VarChar(40)
  personId                        String?          @db.Uuid()
  person                          Person?          @relation("PersonSocialMediaPersonPersonId", fields: [personId], references: [id])
  socialMediaId                   String?          @db.Uuid()
  socialMedia                     SocialMediaType? @relation("PersonSocialMediaSocialMediaTypeSocialMediaId", fields: [socialMediaId], references: [id])
  username                        String
  url                             String
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean          @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean          @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean          @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String           @db.Uuid() // Identifier for the client associated.
  createdBy                       String           @db.Uuid() // User ID of the creator.
  updatedBy                       String           @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime         @default(now()) // Creation timestamp.
  updatedAt                       DateTime         @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?          @db.Uuid()
  workflowInstanceId              String?          @db.Uuid()
  isSystemTemplate                Boolean          @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Links a person (contact) to a specific marketing list for targeted campaigns and
// communications.
model PersonInMarketingList {
  id                              String        @id @default(uuid()) @db.Uuid()
  expiryDate                      DateTime?     @db.Date
  color                           String?       @db.VarChar(40)
  marketingListId                 String        @db.Uuid()
  marketingList                   MarketingList @relation("PersonInMarketingListMarketingListMarketingListId", fields: [marketingListId], references: [id])
  personId                        String        @db.Uuid()
  person                          Person        @relation("PersonInMarketingListPersonPersonId", fields: [personId], references: [id])
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean       @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean       @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean       @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String        @db.Uuid() // Identifier for the client associated.
  createdBy                       String        @db.Uuid() // User ID of the creator.
  updatedBy                       String        @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime      @default(now()) // Creation timestamp.
  updatedAt                       DateTime      @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?       @db.Uuid()
  workflowInstanceId              String?       @db.Uuid()
  isSystemTemplate                Boolean       @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Defines the relationship between two people, such as 'Reports To', 'Colleague',
// or 'Spouse'.
model PersonRelationship {
  id                                                            String                      @id @default(uuid()) @db.Uuid()
  personId                                                      String                      @db.Uuid()
  person                                                        Person                      @relation("PersonRelationshipPersonPersonId", fields: [personId], references: [id])
  color                                                         String?                     @db.VarChar(40)
  relationshipId                                                String                      @db.Uuid()
  relationship                                                  Relationship                @relation("PersonRelationshipRelationshipRelationshipId", fields: [relationshipId], references: [id])
  personRelationshipPersonRelationshipHistoryPersonRelationship PersonRelationshipHistory[] @relation("PersonRelationshipHistoryPersonRelationshipPersonRelationshipId")
  tags                                                          String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                                              Boolean                     @default(false) // Visibility control.
  anonymousCanSeeIt                                             Boolean                     @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt                               Boolean                     @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                                        Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                                        Json? // Specific users with visibility access.
  client                                                        String                      @db.Uuid() // Identifier for the client associated.
  createdBy                                                     String                      @db.Uuid() // User ID of the creator.
  updatedBy                                                     String                      @db.Uuid() // User ID of the last updater.
  createdAt                                                     DateTime                    @default(now()) // Creation timestamp.
  updatedAt                                                     DateTime                    @updatedAt // Last update timestamp.
  deleted                                                       DateTime? // Deletion timestamp, if deleted.
  workflowId                                                    String?                     @db.Uuid()
  workflowInstanceId                                            String?                     @db.Uuid()
  isSystemTemplate                                              Boolean                     @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Assigns a user as the owner or manager of a specific sales territory.
model TerritoryOwner {
  id                              String     @id @default(uuid()) @db.Uuid()
  color                           String?    @db.VarChar(40)
  expiryDate                      DateTime?  @db.Date
  territoryId                     String?    @db.Uuid()
  territory                       Territory? @relation("TerritoryOwnerTerritoryTerritoryId", fields: [territoryId], references: [id])
  salesPersonId                   String     @db.Uuid()
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean    @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean    @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean    @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String     @db.Uuid() // Identifier for the client associated.
  createdBy                       String     @db.Uuid() // User ID of the creator.
  updatedBy                       String     @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime   @default(now()) // Creation timestamp.
  updatedAt                       DateTime   @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?    @db.Uuid()
  workflowInstanceId              String?    @db.Uuid()
  isSystemTemplate                Boolean    @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt, salesPersonId])
}

// A person who is a contact point within a specific company, linking a person
// record to a company record.
model CompanyContact {
  id                                                String                  @id @default(uuid()) @db.Uuid()
  color                                             String?                 @db.VarChar(40)
  workPhone                                         String?                 @db.VarChar(25)
  jobTitle                                          String?
  accounts                                          Boolean?
  personId                                          String                  @db.Uuid()
  person                                            Person                  @relation("CompanyContactPersonPersonId", fields: [personId], references: [id])
  companyId                                         String?                 @db.Uuid()
  company                                           Company?                @relation("CompanyContactCompanyCompanyId", fields: [companyId], references: [id])
  workMobile                                        String?                 @db.VarChar(25)
  startDate                                         DateTime?               @db.Date
  endDate                                           DateTime?               @db.Date
  workEmail                                         String?
  companyContactOpportunityCompanyContact           Opportunity[]           @relation("OpportunityCompanyContactCompanyContactId")
  companyContactClientCompanyContact                Client[]                @relation("ClientCompanyContactCompanyContactId")
  companyContactOpportunityInfluencerCompanyContact OpportunityInfluencer[] @relation("OpportunityInfluencerCompanyContactCompanyContactId")
  tags                                              String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                                  Boolean                 @default(false) // Visibility control.
  anonymousCanSeeIt                                 Boolean                 @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt                   Boolean                 @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                            Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                            Json? // Specific users with visibility access.
  client                                            String                  @db.Uuid() // Identifier for the client associated.
  createdBy                                         String                  @db.Uuid() // User ID of the creator.
  updatedBy                                         String                  @db.Uuid() // User ID of the last updater.
  createdAt                                         DateTime                @default(now()) // Creation timestamp.
  updatedAt                                         DateTime                @updatedAt // Last update timestamp.
  deleted                                           DateTime? // Deletion timestamp, if deleted.
  workflowId                                        String?                 @db.Uuid()
  workflowInstanceId                                String?                 @db.Uuid()
  isSystemTemplate                                  Boolean                 @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Records an enquiry or question submitted by a customer or prospect.
model CustomerEnquiry {
  id                              String                  @id @default(uuid()) @db.Uuid()
  firstName                       String?
  phone                           String?                 @db.VarChar(30)
  sourceNotes                     String?
  color                           String?                 @db.VarChar(40)
  personId                        String                  @db.Uuid()
  person                          Person                  @relation("CustomerEnquiryPersonPersonId", fields: [personId], references: [id])
  lastName                        String?
  statusId                        String?                 @db.Uuid()
  status                          CustomerEnquiryStatus?  @relation("CustomerEnquiryCustomerEnquiryStatusStatusId", fields: [statusId], references: [id])
  message                         String?
  purposeId                       String?                 @db.Uuid()
  purpose                         CustomerEnquiryPurpose? @relation("CustomerEnquiryCustomerEnquiryPurposePurposeId", fields: [purposeId], references: [id])
  source                          String?
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean                 @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean                 @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean                 @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String                  @db.Uuid() // Identifier for the client associated.
  createdBy                       String                  @db.Uuid() // User ID of the creator.
  updatedBy                       String                  @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime                @default(now()) // Creation timestamp.
  updatedAt                       DateTime                @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?                 @db.Uuid()
  workflowInstanceId              String?                 @db.Uuid()
  isSystemTemplate                Boolean                 @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// A curated list of people or leads to be contacted by phone as part of a specific
// campaign or daily workflow.
model CallList {
  id                              String           @id @default(uuid()) @db.Uuid()
  color                           String?          @db.VarChar(40)
  name                            String
  callListPipelineId              String           @db.Uuid()
  callListPipeline                CallListPipeline @relation("CallListCallListPipelineCallListPipelineId", fields: [callListPipelineId], references: [id])
  description                     String?
  callListCallScheduleCallList    CallSchedule[]   @relation("CallScheduleCallListCallListId")
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean          @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean          @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean          @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String           @db.Uuid() // Identifier for the client associated.
  createdBy                       String           @db.Uuid() // User ID of the creator.
  updatedBy                       String           @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime         @default(now()) // Creation timestamp.
  updatedAt                       DateTime         @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?          @db.Uuid()
  workflowInstanceId              String?          @db.Uuid()
  isSystemTemplate                Boolean          @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Tracks the history of relationships a person has had, including when they
// started, ended, or changed.
model PersonRelationshipHistory {
  id                              String             @id @default(uuid()) @db.Uuid()
  personRelationshipId            String             @db.Uuid()
  personRelationship              PersonRelationship @relation("PersonRelationshipHistoryPersonRelationshipPersonRelationshipId", fields: [personRelationshipId], references: [id])
  notes                           String
  color                           String?            @db.VarChar(40)
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean            @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean            @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean            @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String             @db.Uuid() // Identifier for the client associated.
  createdBy                       String             @db.Uuid() // User ID of the creator.
  updatedBy                       String             @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime           @default(now()) // Creation timestamp.
  updatedAt                       DateTime           @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?            @db.Uuid()
  workflowInstanceId              String?            @db.Uuid()
  isSystemTemplate                Boolean            @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Sets a sales or activity target for a specific salesperson over a defined
// period.
model SalesPersonTarget {
  id                                         String                @id @default(uuid()) @db.Uuid()
  target                                     Int?
  targetUnit                                 TargetFrequency?
  color                                      String?               @db.VarChar(40)
  pipelineStageId                            String                @db.Uuid()
  pipelineStage                              PipelineStage         @relation("SalesPersonTargetPipelineStagePipelineStageId", fields: [pipelineStageId], references: [id])
  salesPersonId                              String                @db.Uuid()
  pipelineId                                 String                @db.Uuid()
  pipeline                                   Pipeline              @relation("SalesPersonTargetPipelinePipelineId", fields: [pipelineId], references: [id])
  notes                                      String?
  expiryDate                                 DateTime?             @db.Date
  salesPersonTargetTargetActualHistoryTarget TargetActualHistory[] @relation("TargetActualHistorySalesPersonTargetTargetId")
  tags                                       String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                           Boolean               @default(false) // Visibility control.
  anonymousCanSeeIt                          Boolean               @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt            Boolean               @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                     Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                     Json? // Specific users with visibility access.
  client                                     String                @db.Uuid() // Identifier for the client associated.
  createdBy                                  String                @db.Uuid() // User ID of the creator.
  updatedBy                                  String                @db.Uuid() // User ID of the last updater.
  createdAt                                  DateTime              @default(now()) // Creation timestamp.
  updatedAt                                  DateTime              @updatedAt // Last update timestamp.
  deleted                                    DateTime? // Deletion timestamp, if deleted.
  workflowId                                 String?               @db.Uuid()
  workflowInstanceId                         String?               @db.Uuid()
  isSystemTemplate                           Boolean               @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt, salesPersonId])
}

// Represents a potential revenue-generating deal that is being tracked through the
// sales pipeline.
model Opportunity {
  id                                          String                   @id @default(uuid()) @db.Uuid()
  companyId                                   String?                  @db.Uuid()
  company                                     Company?                 @relation("OpportunityCompanyCompanyId", fields: [companyId], references: [id])
  personId                                    String?                  @db.Uuid()
  person                                      Person?                  @relation("OpportunityPersonPersonId", fields: [personId], references: [id])
  statusId                                    String?                  @db.Uuid()
  status                                      PipelineStage?           @relation("OpportunityPipelineStageStatusId", fields: [statusId], references: [id])
  sentiment                                   String?                  @db.VarChar(12)
  dataSource                                  String?
  actualValue                                 Int?
  probability                                 Int?
  economicBuyerInfluenceId                    String?                  @db.Uuid()
  economicBuyerInfluence                      CompanySpin?             @relation("OpportunityCompanySpinEconomicBuyerInfluenceId", fields: [economicBuyerInfluenceId], references: [id])
  salesPersonId                               String?                  @db.Uuid()
  ownerId                                     String?                  @db.Uuid()
  companyContactId                            String?                  @db.Uuid()
  companyContact                              CompanyContact?          @relation("OpportunityCompanyContactCompanyContactId", fields: [companyContactId], references: [id])
  color                                       String?                  @db.VarChar(40)
  notes                                       String?
  technicalBuyerInfluenceId                   String?                  @db.Uuid()
  technicalBuyerInfluence                     CompanySpin?             @relation("OpportunityCompanySpinTechnicalBuyerInfluenceId", fields: [technicalBuyerInfluenceId], references: [id])
  name                                        String                   @db.VarChar(50)
  statusAssignedDate                          DateTime?
  pipelineId                                  String?                  @db.Uuid()
  pipeline                                    Pipeline?                @relation("OpportunityPipelinePipelineId", fields: [pipelineId], references: [id])
  description                                 String?
  estimatedValue                              Int?
  estimatedCloseDate                          DateTime?                @db.Date
  userBuyerInfluenceId                        String?                  @db.Uuid()
  userBuyerInfluence                          CompanySpin?             @relation("OpportunityCompanySpinUserBuyerInfluenceId", fields: [userBuyerInfluenceId], references: [id])
  customerPriority                            String?                  @db.VarChar(7)
  channelId                                   String?                  @db.Uuid()
  channel                                     Channel?                 @relation("OpportunityChannelChannelId", fields: [channelId], references: [id])
  categoryId                                  String?                  @db.Uuid()
  category                                    OpportunityCategory?     @relation(name: "OpportunityToCategory", fields: [categoryId], references: [id])
  search_vector                               Unsupported("tsvector")? @map("search_vector")
  opportunityClientOpportunity                Client[]                 @relation("ClientOpportunityOpportunityId")
  opportunityOpportunityInfluencerOpportunity OpportunityInfluencer[]  @relation("OpportunityInfluencerOpportunityOpportunityId")
  opportunityOpportunityProductOpportunity    OpportunityProduct[]     @relation("OpportunityProductOpportunityOpportunityId")
  opportunityOpportunityHistoryOpportunity    OpportunityHistory[]     @relation("OpportunityHistoryOpportunityOpportunityId")
  opportunityActionPlanOpportunity            ActionPlan[]             @relation("ActionPlanOpportunityOpportunityId")
  opportunityDataNeededOpportunity            DataNeeded[]             @relation("DataNeededOpportunityOpportunityId")
  tags                                        String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                            Boolean                  @default(false) // Visibility control.
  anonymousCanSeeIt                           Boolean                  @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt             Boolean                  @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt                      Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt                      Json? // Specific users with visibility access.
  client                                      String                   @db.Uuid() // Identifier for the client associated.
  createdBy                                   String                   @db.Uuid() // User ID of the creator.
  updatedBy                                   String                   @db.Uuid() // User ID of the last updater.
  createdAt                                   DateTime                 @default(now()) // Creation timestamp.
  updatedAt                                   DateTime                 @updatedAt // Last update timestamp.
  deleted                                     DateTime? // Deletion timestamp, if deleted.
  workflowId                                  String?                  @db.Uuid()
  workflowInstanceId                          String?                  @db.Uuid()
  isSystemTemplate                            Boolean                  @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt, salesPersonId, ownerId])
  @@index([pipelineId, deleted, createdAt])
  @@index([statusId, deleted])
}

model OpportunityCategory {
  id                              String        @id @default(uuid()) @db.Uuid()
  name                            String        @db.VarChar(150)
  description                     String?
  opportunities                   Opportunity[] @relation("OpportunityToCategory")
  color                           String?       @db.VarChar(40)
  tags                            String?
  everyoneCanSeeIt                Boolean       @default(false)
  anonymousCanSeeIt               Boolean       @default(false)
  everyoneInObjectCompanyCanSeeIt Boolean       @default(true)
  onlyTheseRolesCanSeeIt          Json?
  onlyTheseUsersCanSeeIt          Json?
  client                          String        @db.Uuid()
  createdBy                       String        @db.Uuid()
  updatedBy                       String        @db.Uuid()
  createdAt                       DateTime      @default(now())
  updatedAt                       DateTime      @updatedAt
  deleted                         DateTime?
  workflowId                      String?       @db.Uuid()
  workflowInstanceId              String?       @db.Uuid()
  isSystemTemplate                Boolean       @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Schedules and manages planned phone calls with contacts, leads, or customers.
model CallSchedule {
  id                                  String                @id @default(uuid()) @db.Uuid()
  callListPipelineStageId             String                @db.Uuid()
  callListPipelineStage               CallListPipelineStage @relation("CallScheduleCallListPipelineStageCallListPipelineStageId", fields: [callListPipelineStageId], references: [id])
  callListId                          String?               @db.Uuid()
  callList                            CallList?             @relation("CallScheduleCallListCallListId", fields: [callListId], references: [id])
  color                               String?               @db.VarChar(40)
  scheduleDatetime                    DateTime
  personId                            String                @db.Uuid()
  person                              Person                @relation("CallSchedulePersonPersonId", fields: [personId], references: [id])
  callScheduleCallHistoryCallSchedule CallHistory[]         @relation("CallHistoryCallScheduleCallScheduleId")
  tags                                String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                    Boolean               @default(false) // Visibility control.
  anonymousCanSeeIt                   Boolean               @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt     Boolean               @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt              Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt              Json? // Specific users with visibility access.
  client                              String                @db.Uuid() // Identifier for the client associated.
  createdBy                           String                @db.Uuid() // User ID of the creator.
  updatedBy                           String                @db.Uuid() // User ID of the last updater.
  createdAt                           DateTime              @default(now()) // Creation timestamp.
  updatedAt                           DateTime              @updatedAt // Last update timestamp.
  deleted                             DateTime? // Deletion timestamp, if deleted.
  workflowId                          String?               @db.Uuid()
  workflowInstanceId                  String?               @db.Uuid()
  isSystemTemplate                    Boolean               @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
  // Optimize duplicate detection and list filters
  @@index([client, deleted, personId, callListId, callListPipelineStageId])
  @@index([client, deleted, callListPipelineStageId, scheduleDatetime])
}

// Represents a client or customer, typically an organization or company that you
// do business with.
model Client {
  id                              String          @id @default(uuid()) @db.Uuid()
  opportunityId                   String?         @db.Uuid()
  opportunity                     Opportunity?    @relation("ClientOpportunityOpportunityId", fields: [opportunityId], references: [id])
  notes                           String?
  companyContactId                String          @db.Uuid()
  companyContact                  CompanyContact  @relation("ClientCompanyContactCompanyContactId", fields: [companyContactId], references: [id])
  color                           String?         @db.VarChar(40)
  clientClientHistoryClientRef    ClientHistory[] @relation("ClientHistoryClientClientRefId")
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean         @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean         @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean         @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String          @db.Uuid() // Identifier for the client associated.
  createdBy                       String          @db.Uuid() // User ID of the creator.
  updatedBy                       String          @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime        @default(now()) // Creation timestamp.
  updatedAt                       DateTime        @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?         @db.Uuid()
  workflowInstanceId              String?         @db.Uuid()
  isSystemTemplate                Boolean         @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
  // Performance: support controller-level uniqueness and frequent lookups
  @@index([client, deleted, opportunityId])
  @@index([client, deleted, companyContactId])
}

// Stores historical data of actual performance values against defined targets,
// enabling performance tracking over time.
model TargetActualHistory {
  id                              String            @id @default(uuid()) @db.Uuid()
  color                           String?           @db.VarChar(40)
  targetId                        String            @db.Uuid()
  target                          SalesPersonTarget @relation("TargetActualHistorySalesPersonTargetTargetId", fields: [targetId], references: [id])
  actuals                         Int
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean           @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean           @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean           @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String            @db.Uuid() // Identifier for the client associated.
  createdBy                       String            @db.Uuid() // User ID of the creator.
  updatedBy                       String            @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime          @default(now()) // Creation timestamp.
  updatedAt                       DateTime          @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?           @db.Uuid()
  workflowInstanceId              String?           @db.Uuid()
  isSystemTemplate                Boolean           @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Identifies and tracks individuals who have an influence on a sales opportunity,
// even if they are not the primary decision-maker.
model OpportunityInfluencer {
  id                              String         @id @default(uuid()) @db.Uuid()
  role                            String
  desireForSelf                   String?
  color                           String?        @db.VarChar(40)
  rating                          Int?
  companyContactId                String         @db.Uuid()
  companyContact                  CompanyContact @relation("OpportunityInfluencerCompanyContactCompanyContactId", fields: [companyContactId], references: [id])
  desireForCompany                String?
  opportunityId                   String?        @db.Uuid()
  opportunity                     Opportunity?   @relation("OpportunityInfluencerOpportunityOpportunityId", fields: [opportunityId], references: [id])
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean        @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean        @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean        @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String         @db.Uuid() // Identifier for the client associated.
  createdBy                       String         @db.Uuid() // User ID of the creator.
  updatedBy                       String         @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime       @default(now()) // Creation timestamp.
  updatedAt                       DateTime       @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?        @db.Uuid()
  workflowInstanceId              String?        @db.Uuid()
  isSystemTemplate                Boolean        @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
  // Indexes to optimize duplicate checks and common filters
  @@index([client, deleted, opportunityId, companyContactId])
  @@index([opportunityId, deleted])
  @@index([companyContactId, deleted])
}

// Links a specific product or service to an opportunity, including details like
// quantity, price, and total amount.
model OpportunityProduct {
  id                              String      @id @default(uuid()) @db.Uuid()
  color                           String?     @db.VarChar(40)
  amount                          Int?
  estimatedValue                  Int?
  opportunityId                   String      @db.Uuid()
  opportunity                     Opportunity @relation("OpportunityProductOpportunityOpportunityId", fields: [opportunityId], references: [id])
  productVariantId                String      @db.Uuid() // Product Variant ID from Inventory microservice
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean     @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean     @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean     @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String      @db.Uuid() // Identifier for the client associated.
  createdBy                       String      @db.Uuid() // User ID of the creator.
  updatedBy                       String      @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime    @default(now()) // Creation timestamp.
  updatedAt                       DateTime    @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?     @db.Uuid()
  workflowInstanceId              String?     @db.Uuid()
  isSystemTemplate                Boolean     @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt, productVariantId])
}

// A historical log of all changes made to an opportunity, such as stage changes,
// value adjustments, or closing date updates.
model OpportunityHistory {
  id                              String       @id @default(uuid()) @db.Uuid()
  opportunityId                   String?      @db.Uuid()
  opportunity                     Opportunity? @relation("OpportunityHistoryOpportunityOpportunityId", fields: [opportunityId], references: [id])
  notes                           String
  url                             String?
  color                           String?      @db.VarChar(40)
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean      @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean      @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean      @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String       @db.Uuid() // Identifier for the client associated.
  createdBy                       String       @db.Uuid() // User ID of the creator.
  updatedBy                       String       @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime     @default(now()) // Creation timestamp.
  updatedAt                       DateTime     @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?      @db.Uuid()
  workflowInstanceId              String?      @db.Uuid()
  isSystemTemplate                Boolean      @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// A predefined set or template of actions designed to achieve a specific
// objective, such as onboarding a new client.
model ActionPlan {
  id                              String      @id @default(uuid()) @db.Uuid()
  opportunityId                   String      @db.Uuid()
  opportunity                     Opportunity @relation("ActionPlanOpportunityOpportunityId", fields: [opportunityId], references: [id])
  who                             String?
  what                            String
  when                            DateTime?   @db.Date
  color                           String?     @db.VarChar(40)
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean     @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean     @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean     @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String      @db.Uuid() // Identifier for the client associated.
  createdBy                       String      @db.Uuid() // User ID of the creator.
  updatedBy                       String      @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime    @default(now()) // Creation timestamp.
  updatedAt                       DateTime    @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?     @db.Uuid()
  workflowInstanceId              String?     @db.Uuid()
  isSystemTemplate                Boolean     @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Flags records or fields where specific information is required but is currently
// missing.
model DataNeeded {
  id                              String       @id @default(uuid()) @db.Uuid()
  whoFrom                         String
  opportunityId                   String?      @db.Uuid()
  opportunity                     Opportunity? @relation("DataNeededOpportunityOpportunityId", fields: [opportunityId], references: [id])
  infoNeeded                      String
  notes                           String?
  color                           String?      @db.VarChar(40)
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean      @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean      @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean      @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String       @db.Uuid() // Identifier for the client associated.
  createdBy                       String       @db.Uuid() // User ID of the creator.
  updatedBy                       String       @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime     @default(now()) // Creation timestamp.
  updatedAt                       DateTime     @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?      @db.Uuid()
  workflowInstanceId              String?      @db.Uuid()
  isSystemTemplate                Boolean      @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// A historical log of all phone calls made or received, including details like
// duration and outcome.
model CallHistory {
  id                              String                @id @default(uuid()) @db.Uuid()
  callScheduleId                  String?               @db.Uuid()
  callSchedule                    CallSchedule?         @relation("CallHistoryCallScheduleCallScheduleId", fields: [callScheduleId], references: [id])
  outcome                         String
  color                           String?               @db.VarChar(40)
  callListPipelineStageId         String                @db.Uuid()
  callListPipelineStage           CallListPipelineStage @relation("CallHistoryCallListPipelineStageCallListPipelineStageId", fields: [callListPipelineStageId], references: [id])
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean               @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean               @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean               @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String                @db.Uuid() // Identifier for the client associated.
  createdBy                       String                @db.Uuid() // User ID of the creator.
  updatedBy                       String                @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime              @default(now()) // Creation timestamp.
  updatedAt                       DateTime              @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?               @db.Uuid()
  workflowInstanceId              String?               @db.Uuid()
  isSystemTemplate                Boolean               @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// A log of all significant changes and interactions associated with a client
// account, providing a complete audit trail.
model ClientHistory {
  id                              String    @id @default(uuid()) @db.Uuid()
  clientRefId                     String?   @db.Uuid()
  clientRef                       Client?   @relation("ClientHistoryClientClientRefId", fields: [clientRefId], references: [id])
  url                             String
  color                           String?   @db.VarChar(40)
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean   @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean   @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean   @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String    @db.Uuid() // Identifier for the client associated.
  createdBy                       String    @db.Uuid() // User ID of the creator.
  updatedBy                       String    @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime  @default(now()) // Creation timestamp.
  updatedAt                       DateTime  @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?   @db.Uuid()
  workflowInstanceId              String?   @db.Uuid()
  isSystemTemplate                Boolean   @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

// Manages and stores data submitted by users through an online signup form.
model OnlineSignup {
  id                              String    @id @default(uuid()) @db.Uuid()
  owner                           String    @db.VarChar(200)
  color                           String?   @db.VarChar(40)
  fields                          String?
  source                          String?
  emailconfirmed                  Boolean?
  tags                            String? // Optional tags for easier categorization or search.
  everyoneCanSeeIt                Boolean   @default(false) // Visibility control.
  anonymousCanSeeIt               Boolean   @default(false) // Visibility control for anonymous users.
  everyoneInObjectCompanyCanSeeIt Boolean   @default(true) // Company-wide visibility.
  onlyTheseRolesCanSeeIt          Json? // Specific roles with visibility access.
  onlyTheseUsersCanSeeIt          Json? // Specific users with visibility access.
  client                          String    @db.Uuid() // Identifier for the client associated.
  createdBy                       String    @db.Uuid() // User ID of the creator.
  updatedBy                       String    @db.Uuid() // User ID of the last updater.
  createdAt                       DateTime  @default(now()) // Creation timestamp.
  updatedAt                       DateTime  @updatedAt // Last update timestamp.
  deleted                         DateTime? // Deletion timestamp, if deleted.
  workflowId                      String?   @db.Uuid()
  workflowInstanceId              String?   @db.Uuid()
  isSystemTemplate                Boolean   @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

model Prospect {
  id                              String                          @id @default(uuid()) @db.Uuid()
  personId                        String                          @db.Uuid()
  person                          Person                          @relation(name: "ProspectToPerson", fields: [personId], references: [id])
  ownerId                         String                          @db.Uuid() // Employee ID from HR
  sourceCampaignId                String?                         @db.Uuid() // Campaign ID from Marketing microservice
  categoryId                      String                          @db.Uuid()
  category                        ProspectCategory                @relation(name: "ProspectToCategory", fields: [categoryId], references: [id])
  statusId                        String?                         @db.Uuid() // maps to ProspectPipelineStage.id
  status                          ProspectPipelineStage?          @relation(name: "ProspectToStage", fields: [statusId], references: [id])
  prospectPipelineId              String?                         @db.Uuid()
  prospectPipeline                ProspectPipeline?               @relation(name: "ProspectToPipeline", fields: [prospectPipelineId], references: [id])
  qualificationScore              Int                             @default(0)
  interestSummary                 String?
  temperature                     ProspectTemperature
  disqualificationReason          ProspectDisqualificationReason?
  products                        ProspectProduct[]               @relation(name: "ProspectToProducts")
  color                           String?                         @db.VarChar(40)
  tags                            String?
  everyoneCanSeeIt                Boolean                         @default(false)
  anonymousCanSeeIt               Boolean                         @default(false)
  everyoneInObjectCompanyCanSeeIt Boolean                         @default(true)
  onlyTheseRolesCanSeeIt          Json?
  onlyTheseUsersCanSeeIt          Json?
  client                          String                          @db.Uuid()
  createdBy                       String                          @db.Uuid()
  updatedBy                       String                          @db.Uuid()
  createdAt                       DateTime                        @default(now())
  updatedAt                       DateTime                        @updatedAt
  deleted                         DateTime?
  workflowId                      String?                         @db.Uuid()
  workflowInstanceId              String?                         @db.Uuid()
  isSystemTemplate                Boolean                         @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
  @@index([categoryId, statusId, deleted])
}

model ProspectProduct {
  id                              String    @id @default(uuid()) @db.Uuid()
  amount                          Int?
  estimatedValue                  Int?
  prospectId                      String    @db.Uuid()
  prospect                        Prospect  @relation(name: "ProspectToProducts", fields: [prospectId], references: [id])
  productVariantId                String    @db.Uuid()
  color                           String?   @db.VarChar(40)
  tags                            String?
  everyoneCanSeeIt                Boolean   @default(false)
  anonymousCanSeeIt               Boolean   @default(false)
  everyoneInObjectCompanyCanSeeIt Boolean   @default(true)
  onlyTheseRolesCanSeeIt          Json?
  onlyTheseUsersCanSeeIt          Json?
  client                          String    @db.Uuid()
  createdBy                       String    @db.Uuid()
  updatedBy                       String    @db.Uuid()
  createdAt                       DateTime  @default(now())
  updatedAt                       DateTime  @updatedAt
  deleted                         DateTime?
  workflowId                      String?   @db.Uuid()
  workflowInstanceId              String?   @db.Uuid()
  isSystemTemplate                Boolean   @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt, productVariantId])
  @@index([prospectId, deleted])
}

model ProspectCategory {
  id                              String     @id @default(uuid()) @db.Uuid()
  name                            String     @db.VarChar(150)
  description                     String?
  prospects                       Prospect[] @relation("ProspectToCategory")
  color                           String?    @db.VarChar(40)
  tags                            String?
  everyoneCanSeeIt                Boolean    @default(false)
  anonymousCanSeeIt               Boolean    @default(false)
  everyoneInObjectCompanyCanSeeIt Boolean    @default(true)
  onlyTheseRolesCanSeeIt          Json?
  onlyTheseUsersCanSeeIt          Json?
  client                          String     @db.Uuid()
  createdBy                       String     @db.Uuid()
  updatedBy                       String     @db.Uuid()
  createdAt                       DateTime   @default(now())
  updatedAt                       DateTime   @updatedAt
  deleted                         DateTime?
  workflowId                      String?    @db.Uuid()
  workflowInstanceId              String?    @db.Uuid()
  isSystemTemplate                Boolean    @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

model ProspectPipeline {
  id                              String                  @id @default(uuid()) @db.Uuid()
  color                           String?                 @db.VarChar(40)
  description                     String?
  name                            String                  @db.VarChar(50)
  stages                          ProspectPipelineStage[] @relation(name: "PipelineToStages")
  prospects                       Prospect[]              @relation(name: "ProspectToPipeline")
  tags                            String?
  everyoneCanSeeIt                Boolean                 @default(false)
  anonymousCanSeeIt               Boolean                 @default(false)
  everyoneInObjectCompanyCanSeeIt Boolean                 @default(true)
  onlyTheseRolesCanSeeIt          Json?
  onlyTheseUsersCanSeeIt          Json?
  client                          String                  @db.Uuid()
  createdBy                       String                  @db.Uuid()
  updatedBy                       String                  @db.Uuid()
  createdAt                       DateTime                @default(now())
  updatedAt                       DateTime                @updatedAt
  deleted                         DateTime?
  workflowId                      String?                 @db.Uuid()
  workflowInstanceId              String?                 @db.Uuid()
  isSystemTemplate                Boolean                 @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
}

model ProspectPipelineStage {
  id                              String                  @id @default(uuid()) @db.Uuid()
  parentPipelineStageId           String?                 @db.Uuid()
  parent                          ProspectPipelineStage?  @relation(name: "StageHierarchy", fields: [parentPipelineStageId], references: [id])
  children                        ProspectPipelineStage[] @relation(name: "StageHierarchy")
  pipelineId                      String?                 @db.Uuid()
  pipeline                        ProspectPipeline?       @relation(name: "PipelineToStages", fields: [pipelineId], references: [id])
  prospects                       Prospect[]              @relation(name: "ProspectToStage")
  order                           Int
  immediateNextAction             String?                 @db.VarChar(200)
  description                     String?
  confidence                      Int
  color                           String?                 @db.VarChar(40)
  rottingDays                     Int
  conversion                      Int
  stage                           String                  @db.VarChar(150)
  tags                            String?
  everyoneCanSeeIt                Boolean                 @default(false)
  anonymousCanSeeIt               Boolean                 @default(false)
  everyoneInObjectCompanyCanSeeIt Boolean                 @default(true)
  onlyTheseRolesCanSeeIt          Json?
  onlyTheseUsersCanSeeIt          Json?
  client                          String                  @db.Uuid()
  createdBy                       String                  @db.Uuid()
  updatedBy                       String                  @db.Uuid()
  createdAt                       DateTime                @default(now())
  updatedAt                       DateTime                @updatedAt
  deleted                         DateTime?
  workflowId                      String?                 @db.Uuid()
  workflowInstanceId              String?                 @db.Uuid()
  isSystemTemplate                Boolean                 @default(false)

  @@index([everyoneCanSeeIt, anonymousCanSeeIt, everyoneInObjectCompanyCanSeeIt, onlyTheseRolesCanSeeIt, onlyTheseUsersCanSeeIt, client, createdBy, isSystemTemplate, deleted, createdAt, updatedAt])
  @@index([pipelineId, deleted, order])
}
